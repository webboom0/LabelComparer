<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Label Comparer</title>
  <meta name="robots" content="noindex,nofollow">
  <meta name="keywords" content="Label Comparer, 라벨비교">
  <meta name="description" content="Label Comparer">
  <link rel="shortcut icon" href="images/favicon.ico">
  <!-- css -->
  <link rel="stylesheet" href="css/aos.css">
  <link rel="stylesheet" href="css/default.css">
  <link rel="stylesheet" href="css/sub.css">
  <!-- js -->
  <script src="js/aos.js"></script>
  <script src="js/nav.js"></script>
  <script src="js/lib.js"></script>
  <script src="js/asyncAlert.js"></script>
</head>

<body>
  <!-- skip -->
  <div id="skipNav">
    <ul>
      <li><a href="#contents">본문 바로가기</a></li>
      <li><a href="#gnb">주메뉴 바로가기</a></li>
    </ul>
  </div>
  <div class="wrap sub-wrap">
    <!--header  -->
    <header class="header">
      <div class="container">
        <div class="header-left">
          <h1 class="logo"><a href="#"><span class="blind">Label Comparer</span></a></h1>
          <!-- gnb -->
          <nav class="gnb" id="gnb">
            <button type="button" class="sideMenuCloseBtn" onclick="gnb.close()"><i class="ri-close-fill"></i><span
                class="blind">메뉴닫기</span></button>
            <ul>
              <li class="depth-1">
                <a href="#"><span>서비스 소개</span></a>
              </li>
              <li class="depth-1">
                <a href="#"><span>커뮤니티</span></a>
              </li>
              <li class="depth-1">
                <a href="#"><span>공지사항</span></a>
              </li>
              <li class="depth-1">
                <a href="#"><span>FAQ</span></a>
              </li>
            </ul>
          </nav>
        </div>
        <div class="etcMenu">
          <!-- 로그인 전 -->
          <a href="#" class="login-btn"><span>로그인</span></a>
          <!-- 로그인 후  
            <span class="user-info">홍길동(HONGGD)</span>
            <a href="#" class="logout-btn"><span>로그아웃</span></a>
            -->
          <!-- (모바일) 사이트메뉴 버튼 -->
          <button type="button" class="sideMenuBtn" data-modalClickable='false' aria-label="메뉴 열기"
            aria-expanded="false"><i class="ri-menu-line"></i><span class="blind">메뉴열기</span></button>
        </div>
      </div>
    </header>
    <!-- contents -->
    <div class="contents" id="contents">
      <div class="product-wrap">
        <div class="sub-section">
          <div class="inner">
            <!-- 구독정보 -->
            <section class="round-box">
              <div class="head">
                <h2 class="title">구독정보</h2>
                <a href="javascript:;" class="link" onclick="dialog.open('#change-payment')">변경하기</a>
              </div>
              <div class="body">
                <ul class="list-group">
                  <li class="list-item">
                    <span class="label">구독상품</span>
                    <span class="value">Label Comparer 월 정기구독</span>
                  </li>
                  <li class="list-item">
                    <span class="label">구독기간</span>
                    <span class="value">2025.05.30 ~ 2025.06.30</span>
                  </li>
                  <li class="list-item">
                    <span class="label">다음 결제일</span>
                    <span class="value">2025.06.30</span>
                  </li>
                </ul>
              </div>
            </section>

            <!-- 결제금액 -->
            <section class="round-box mt2">
              <div class="head">
                <h2 class="title">결제금액</h2>
              </div>
              <div class="body">
                <ul class="list-group">
                  <li class="list-item">
                    <span class="label">상품금액</span>
                    <span class="value">18,900원</span>
                  </li>
                  <li class="list-item gray-group">
                    <span class="label">총 결제금액</span>
                    <span class="value fw700">18,900원</span>
                  </li>
                </ul>
              </div>
            </section>

            <!-- 결제수단 -->
            <section class="round-box mt2">
              <div class="head">
                <h2 class="title">결제수단</h2>
              </div>
              <div class="body">
                <ul class="card-group-col2">
                  <li class="list-item">
                    <div class="radio-group">
                      <input type="radio" name="pay-option" id="pay-option1">
                      <label for="pay-option1">
                        <i><img src="images/icon_kakaopay.svg" alt=""></i>
                        <span class="txt">카카오페이</span>
                      </label>
                    </div>
                  </li>
                  <li class="list-item">
                    <div class="radio-group">
                      <input type="radio" name="pay-option" id="pay-option2">
                      <label for="pay-option2">
                        <i><img src="images/icon_naverpay.svg" alt=""></i>
                        <span class="txt">네이버페이이</span>
                      </label>
                    </div>
                  </li>
                  <li class="list-item">
                    <div class="radio-group">
                      <input type="radio" name="pay-option" id="pay-option3">
                      <label for="pay-option3">
                        <i><img src="images/icon_payco.svg" alt=""></i>
                        <span class="txt">페이코</span>
                      </label>
                    </div>
                  </li>
                  <li class="list-item">
                    <div class="radio-group">
                      <input type="radio" name="pay-option" id="pay-option4">
                      <label for="pay-option4">
                        <i><img src="images/icon_card.svg" alt=""></i>
                        <span class="txt">신용카드</span>
                      </label>
                    </div>
                  </li>
                </ul>
              </div>
            </section>

            <!-- 약관동의 -->
            <section class="round-box mt2">
              <div class="head">
                <h2 class="title">약관동의</h2>
              </div>
              <div class="body">
                <button type="button" class="btn-all-agree">
                  <i class="ri-checkbox-circle-fill"></i>
                  <span>약관 전체 동의</span>
                </button>
                <ul class="list-group">
                  <li class="list-item">
                    <div class="agree-btn">
                      <input type="checkbox" class="agree-btn" id="agree-check1">
                      <label for="agree-check1">
                        <span class="label">[필수] 자동결제 상품 인지 및 취소, 환불, 소득공제 정책 등 상품 구매 정책 동의약관 전체 동의</span>
                      </label>
                    </div>
                    <a href="#" class="gray-link">보기</a>
                  </li>
                  <li class="list-item">
                    <div class="agree-btn">
                      <input type="checkbox" class="agree-btn" id="agree-check2">
                      <label for="agree-check2">
                        <span class="label">[필수] 자동결제 상품 인지 및 취소, 환불, 소득공제 정책 등 상품 구매 정책 동의</span>
                      </label>
                    </div>
                    <a href="#" class="gray-link">보기</a>
                  </li>
                </ul>
              </div>
            </section>

            <!-- 결제버튼 -->
            <div class="btn-group mt2">
              <a href="index.html" class="btn-order btn-block" data-disabled="true"
                onclick="handlePaymentClick(event)">결제하기</a>
            </div>
          </div>
          <!-- // .inner -->
        </div>
        <!-- // .sub-section -->
      </div>
      <!-- // .product-wrap -->
    </div>
    <!-- //contents -->
    <!-- footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-top">
          <a href="#">개인정보처리방침</a>
          <a href="#">이용약관</a>
        </div>
        <div class="footer-bottom">
          <div class="footer-info">
            <span>(주)브릴리언트시스템즈</span>
            <span>T. +82-44-865-6602</span>
            <span>F. +82-303-3130-0602</span>
          </div>
          <div class="footer-info">
            <span>info@brillys.com</span>
            <span>세종특별자치시 집현중앙7로 6, 대명벨리온 지식산업센터 B동 1207호</span>
          </div>
        </div>
      </div>
    </footer>
    <!-- //footer -->

    <!-- popup -->
    <div class="dialog" id="change-payment">
      <div class="inner">
        <div class="head">
          <h2 class="title">구독변경</h2>
          <button type="button" class="closeBtn" onclick="dialog.close('#change-payment')"><span
              class="blind">닫기</span></button>
        </div>
        <div class="body">
          <div class="select-group">
            <div class="btn-select">
              <input type="radio" name="product" id="product1" checked>
              <label for="product1">
                <span class="subj">
                  <span class="txt">월 정기구독</span>
                </span>
                <span class="price-group">
                  <strong>
                    <span class="small">월</span>
                    <span class="price">18,900</span>
                    <span class="fw700">원</span>
                  </strong>
                </span>
              </label>
            </div>
            <div class="btn-select">
              <input type="radio" name="product" id="product2">
              <label for="product2">
                <span class="subj">
                  <span class="txt">연 정기구독</span>
                </span>
                <span class="price-group">
                  <em>
                    <span class="cancle">226,800</span>
                    <span class="countdown">15.2% <i class="ri-arrow-down-line"></i></span>
                  </em>
                  <strong>
                    <span class="small">연</span>
                    <span class="price">196,000</span>
                    <span class="fw700">원</span>
                  </strong>
                </span>
              </label>
            </div>
          </div>
          <a href="#" class="btn-order btn-block mt2">변경하기</a>
        </div>
      </div>
    </div>
    <!-- //popup -->
  </div>
  <!-- // wrap -->

  <script>
    // 결제 버튼 클릭 핸들러
    async function handlePaymentClick(event) {
      const paymentBtn = document.querySelector('.btn-order');
      const isDisabled = paymentBtn.getAttribute('data-disabled') === 'true';

      if (isDisabled) {
        // 비활성 상태일 때 기본 링크 이동 방지
        event.preventDefault();

        // 어떤 조건이 누락되었는지 확인
        const selectedPayment = document.querySelector('input[name="pay-option"]:checked');
        const checkboxes = document.querySelectorAll('.list-group input[type="checkbox"]');
        const checkedCount = document.querySelectorAll('.list-group input[type="checkbox"]:checked').length;
        const totalCount = checkboxes.length;

        let warningMessage = '';
        let confirmButtonText = '';

        if (!selectedPayment && checkedCount < totalCount) {
          warningMessage = '결제 방법을 선택하고 모든 약관에 동의해주세요.';
          confirmButtonText = '결제 방법 선택하기';
        } else if (!selectedPayment) {
          warningMessage = '결제 방법을 선택해주세요.';
          confirmButtonText = '결제 방법 선택하기';
        } else if (checkedCount < totalCount) {
          warningMessage = '결제를 진행하려면 모든 약관에 동의해주세요.';
          confirmButtonText = '전체 동의하기';
        }

        // 경고 메시지 표시
        const result = await asyncAlert.fire({
          title: '필수 항목 누락',
          text: warningMessage,
          icon: 'warning',
          confirmButtonText: confirmButtonText,
          cancelButtonText: '취소',
          showCancelButton: true,
          confirmButtonColor: 'primary',
          cancelButtonColor: 'cancel'
        });

        if (result.isConfirmed) {
          if (!selectedPayment) {
            // 결제 방법 선택으로 포커스 이동
            const firstPaymentOption = document.querySelector('input[name="pay-option"]');
            if (firstPaymentOption) {
              firstPaymentOption.focus();
              firstPaymentOption.closest('.list-item').scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
          } else if (checkedCount < totalCount) {
            // 전체 동의 실행
            const btnAllAgree = document.querySelector('.btn-all-agree');
            const checkboxes = document.querySelectorAll('.list-group input[type="checkbox"]');

            // 전체 동의 버튼 활성화
            btnAllAgree.classList.add('active');

            // 모든 체크박스 체크
            checkboxes.forEach(checkbox => {
              checkbox.checked = true;
            });

            // 결제 버튼 상태 즉시 업데이트
            updatePaymentButtonState();

            // 성공 메시지
            await asyncAlert.success('동의 완료', '모든 약관에 동의되었습니다. 이제 결제를 진행할 수 있습니다.');
          }
        }
      } else {
        // 활성 상태일 때는 기본 링크 이동 허용 (event.preventDefault() 호출하지 않음)
        console.log('결제 진행...');
        // href 링크로 자동 이동됨
      }
    }

    // 결제 버튼 상태 업데이트 함수
    function updatePaymentButtonState() {
      const paymentBtn = document.querySelector('.btn-order');
      const checkboxes = document.querySelectorAll('.list-group input[type="checkbox"]');
      const checkedCount = document.querySelectorAll('.list-group input[type="checkbox"]:checked').length;
      const totalCount = checkboxes.length;
      const selectedPayment = document.querySelector('input[name="pay-option"]:checked');

      // 결제 방법 선택과 모든 약관 동의가 모두 완료되었을 때만 활성화
      if (selectedPayment && checkedCount === totalCount && totalCount > 0) {
        paymentBtn.setAttribute('data-disabled', 'false');
        paymentBtn.classList.remove('disabled');
      } else {
        paymentBtn.setAttribute('data-disabled', 'true');
        paymentBtn.classList.add('disabled');
      }
    }

    // lib.js의 기존 이벤트 리스너에 결제 버튼 상태 업데이트 추가
    document.addEventListener('DOMContentLoaded', function () {
      // 기존 lib.js의 전체 동의 기능에 결제 버튼 상태 업데이트 추가
      const btnAllAgree = document.querySelector('.btn-all-agree');
      const checkboxes = document.querySelectorAll('.list-group input[type="checkbox"]');
      const paymentOptions = document.querySelectorAll('input[name="pay-option"]');

      // 전체 동의 버튼 클릭 시 결제 버튼 상태도 업데이트
      if (btnAllAgree) {
        btnAllAgree.addEventListener('click', function () {
          // 기존 동작 후 결제 버튼 상태 업데이트
          setTimeout(updatePaymentButtonState, 0);
        });
      }

      // 개별 체크박스 변경 시 결제 버튼 상태 업데이트
      if (checkboxes.length > 0) {
        checkboxes.forEach(function (checkbox) {
          checkbox.addEventListener('change', updatePaymentButtonState);
        });
      }

      // 결제 방법 선택 변경 시 결제 버튼 상태 업데이트
      if (paymentOptions.length > 0) {
        paymentOptions.forEach(function (option) {
          option.addEventListener('change', updatePaymentButtonState);
        });
      }

      // 초기 상태 설정
      updatePaymentButtonState();
    });
  </script>
</body>